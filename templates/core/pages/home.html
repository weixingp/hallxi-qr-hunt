{% extends "core/base.html" %}
{% load thumbnail %}
{% load static %}
{% load i18n %}
{% block head_title %}{% trans "Home | HALL XI BoB" %}{% endblock %}
{% block extra_head %}
    <style>
        .visited-badge {
            top:6px;
            position:absolute;
            right:6px;
        }
    </style>
{% endblock %}
{% block body %}
    {#    <!-- App Header -->#}
    {#    <div class="appHeader bg-primary scrolled">#}
    {#        <div class="left">#}
    {#            <a href="#" class="headerButton" data-toggle="modal" data-target="#sidebarPanel">#}
    {#                <ion-icon name="menu-outline"></ion-icon>#}
    {#            </a>#}
    {#        </div>#}
    {#        <div class="pageTitle">#}
    {#            Home#}
    {#        </div>#}
    {#    </div>#}
    {#    <!-- * App Header -->#}

    <!-- Cover Image -->
    <img src="{% static "assets/img/bird-cover.gif" %}" class="img-fluid w-100" alt="Birds of Paradise Island">
    <!-- * Cover Image -->

    <!-- Block Info -->
    <div class="section mb-1" style="margin-top: -3em">
        <div class="card">
            <div class="card-body">
                <div>
                    <h6 class="card-subtitle">You belong to</h6>
                    <div class="d-flex justify-content-between align-items-end">
                        <h5 class="card-title mb-0 d-flex align-items-center justify-content-between">
                            Block {{ profile.block.name }}
                        </h5>
                        <div class="chip chip-media chip-info ml-05" style="margin-bottom: 0.2em">
                            <i class="chip-icon bg-dark">
                                <ion-icon name="person-outline" role="img" class="md hydrated" aria-label="person outline"></ion-icon>
                            </i>
                            <span class="chip-label">41</span>
                        </div>
                    </div>

                    <p class="mt-1 mb-0"><b>HP:</b> 1186 / 2000</p>
                    <div class="progress">
                        <div class="progress-bar bg-success" role="progressbar" style="width: 75%;" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100">75%</div>
                    </div>

                    <p class="mt-1 mb-0"><b>Exploration:</b> 20 / 112</p>
                    <div class="progress">
                        <div class="progress-bar bg-warning" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">25%</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- * Block Info -->

    <!-- App Capsule -->
    <div id="appCapsule" class="" style="padding:0 0 56px 0; margin-top: -0.5em;">

        <!-- Assigned Location Cards -->
        <div class="section full mt-3 mb-3">
            <div class="section-title">
                <h2 class="mb-0">Daily Locations</h2>
            </div>
            <div class="content-header mb-2"><h5 class="text-muted">Scan QR code at these locations to gain points and get items for your hall. Locations will be refreshed daily.</h5></div>
            <div class="carousel-multiple owl-carousel owl-theme">
                {% for assigned_location in assigned_locations %}
                    <div class="item">
                        <div class="card">
                            {% if assigned_location.has_visited %}
                                <span class="badge visited-badge badge-success mb-1">visited</span>
                            {% endif %}
                            {% thumbnail assigned_location.location.image "870x660" crop="center" as im %}
                                <img src="{{ im.url }}" class="card-img-top" alt="image">
                            {% endthumbnail %}
                            <div class="card-body pt-2">
                                <h4 class="mb-0">{{ assigned_location.location.name }} </h4>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
        <!-- * Assigned Location Cards -->

        <!-- Assigned Questions -->
        <div class="section full mt-3 mb-3">
            <div class="section-title">
                <h2 class="mb-0">Unanswered Questions</h2>
            </div>
            <p>Placeholder 1</p>
            <p>Placeholder 1</p>
            <p>Placeholder 1</p>
            <p>Placeholder 1</p>
            <p>Placeholder 1</p>
            <p>Placeholder 1</p>
        </div>
        <!-- * Assigned Questions -->

    </div>
    <!-- * App Capsule -->
    {% include "core/sidebar.html" %}
    {% include "core/menu.html" %}
{% endblock %}

{% block extra_script %}
    <script>
        window.onpageshow = function(event) {
            if (event.persisted) {
                window.location.reload();
            }
        };

        function handleVisibilityChange() {
            if(document.hidden) {
                // the page is hidden
            } else {
                window.location.reload();
            }
        }
        document.addEventListener("visibilitychange", handleVisibilityChange, false);

    </script>
    <script>
        window.blockMenuHeaderScroll = false;
        var mc = new Hammer(document);
        var classname = document.getElementsByClassName("owl-carousel");

        mc.on("swipeleft swiperight panleft panright", function(ev) {
            window.blockMenuHeaderScroll = true;
        });

        mc.on("panend swipeend", function (ev){
            window.blockMenuHeaderScroll = false;
        });

        mc.on("swipeup swipedown panup pandown", function(ev) {
            window.blockMenuHeaderScroll = false;
        });

        for (var i = 0; i < classname.length; i++) {
            classname[i].addEventListener('touchmove', function(evt) {
                if (blockMenuHeaderScroll && evt.cancelable) {
                    evt.preventDefault();
                }

            }, {
                passive: false
            });
        }
    </script>
{% endblock %}